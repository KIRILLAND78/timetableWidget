# üìê –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã TimetableWidget

–≠—Ç–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å–æ–¥–µ—Ä–∂–∏—Ç PlantUML –¥–∏–∞–≥—Ä–∞–º–º—ã, –æ–ø–∏—Å—ã–≤–∞—é—â–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –≤–∏–¥–∂–µ—Ç–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –ß—É–≤–ì–£.

## üìä –î–∏–∞–≥—Ä–∞–º–º—ã

### 1. –°—Ç–∞—Ä–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (Windows Forms)
**–§–∞–π–ª:** [`old-architecture.puml`](./old-architecture.puml)

–û–ø–∏—Å—ã–≤–∞–µ—Ç –º–æ–Ω–æ–ª–∏—Ç–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ Windows Forms –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
- –ì–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ –≤–∏–¥–∂–µ—Ç–∞ —Å –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–º –æ–≤–µ—Ä–ª–µ–µ–º
- `TTApiManager.cs` - —Å–∏–Ω–≥–ª—Ç–æ–Ω —Å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–æ–π –∏ API-–≤—ã–∑–æ–≤–∞–º–∏
- `TokenStore.cs` - —Å–∏–Ω–≥–ª—Ç–æ–Ω –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞–º–∏
- `Settings.cs` - —Å–µ—Ä–≤–∏—Å –Ω–∞—Å—Ç—Ä–æ–µ–∫
- –§–æ—Ä–º—ã-–¥–∏–∞–ª–æ–≥–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫

**–ü—Ä–æ–±–ª–µ–º—ã —Å—Ç–∞—Ä–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:**
- –ú–æ–Ω–æ–ª–∏—Ç–Ω–æ—Å—Ç—å - –≤—Å—è –ª–æ–≥–∏–∫–∞ –≤ –æ–¥–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
- –ü—Ä–∏–≤—è–∑–∫–∞ –∫ Windows Forms
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞
- –°–ª–æ–∂–Ω–æ—Å—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫—Ä–æ—Å—Å-–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ—Å—Ç–∏

### 2. –ù–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (Backend + –ö–ª–∏–µ–Ω—Ç—ã)
**–§–∞–π–ª:** [`new-architecture.puml`](./new-architecture.puml)

–û–ø–∏—Å—ã–≤–∞–µ—Ç —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—É—é —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É:

#### **Backend (ASP.NET Core Web API):**
- REST API Controllers (TimetableController, AuthController, SettingsController)
- Services —Å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–æ–π (TimetableService, TokenStoreService, SettingsService)
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (settings.json, tokens.encrypted)

#### **–ö–ª–∏–µ–Ω—Ç—Å–∫–∏–µ –∞–¥–∞–ø—Ç–µ—Ä—ã:**
1. **Windows Forms** - C# –∫–ª–∏–µ–Ω—Ç —Å HTTP –∑–∞–ø—Ä–æ—Å–∞–º–∏ –∫ API
2. **Cinnamon Desklet** - JavaScript/GJS –¥–ª—è Linux Cinnamon
3. **KDE Plasma Widget** - QML/JavaScript –¥–ª—è KDE Plasma
4. **GNOME Shell Extension** - JavaScript/GJS –¥–ª—è GNOME Shell
5. **Python GTK** - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ª—é–±—ã—Ö DE

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:**
- –ï–¥–∏–Ω–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –¥–ª—è –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
- –ö—Ä–æ—Å—Å-–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ—Å—Ç—å (Windows + Linux)
- –õ–µ–≥–∫–æ–≤–µ—Å–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã —Å –Ω–∞—Ç–∏–≤–Ω—ã–º–∏ UI —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞–º–∏
- REST API –¥–ª—è —Ä–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç–∏
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ (DPAPI/file-based encryption)

### 3. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä
**–§–∞–π–ª:** [`architecture-comparison.puml`](./architecture-comparison.puml)

–í–∏–∑—É–∞–ª—å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–π –∏ –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Å –≤—ã–¥–µ–ª–µ–Ω–∏–µ–º:
- –ü—Ä–æ–±–ª–µ–º –º–æ–Ω–æ–ª–∏—Ç–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞
- –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –Ω–∞ Backend/Frontend
- –†–∞–∑–ª–∏—á–∏–π –≤ –ø–æ–¥—Ö–æ–¥–∞—Ö –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –ß—É–≤–ì–£ API

### 4. –î–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
**–§–∞–π–ª:** [`sequence-diagram.puml`](./sequence-diagram.puml)

–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ:
- **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** - –æ—Ç –≤–≤–æ–¥–∞ –ª–æ–≥–∏–Ω–∞/–ø–∞—Ä–æ–ª—è –¥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤
- **–ü–æ–ª—É—á–µ–Ω–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è** - —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –∏—Å—Ç–µ–∫—à–∏—Ö —Ç–æ–∫–µ–Ω–æ–≤ –∏ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è** - –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

–í–∫–ª—é—á–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É edge cases:
- –ò—Å—Ç–µ—á–µ–Ω–∏–µ access token –∏ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ refresh token
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ API
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç

## üõ†Ô∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ PlantUML –¥–∏–∞–≥—Ä–∞–º–º

### –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–∏–∞–≥—Ä–∞–º–º

#### 1. VS Code —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º PlantUML
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ
code --install-extension jebbs.plantuml

# –û—Ç–∫—Ä–æ–π—Ç–µ .puml —Ñ–∞–π–ª –∏ –Ω–∞–∂–º–∏—Ç–µ Alt+D –¥–ª—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
```

#### 2. PlantUML –æ–Ω–ª–∞–π–Ω
–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `.puml` —Ñ–∞–π–ª–∞ –Ω–∞ [PlantUML Online Editor](http://www.plantuml.com/plantuml/uml/)

#### 3. –õ–æ–∫–∞–ª—å–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è PNG/SVG
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ PlantUML
sudo apt install plantuml  # Linux
brew install plantuml      # macOS

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
plantuml docs/*.puml

# –ò–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –¥–∏–∞–≥—Ä–∞–º–º—ã
plantuml docs/new-architecture.puml
```

### –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∏–∞–≥—Ä–∞–º–º

1. –û—Ç–∫—Ä–æ–π—Ç–µ `.puml` —Ñ–∞–π–ª –≤ –ª—é–±–æ–º —Ç–µ–∫—Å—Ç–æ–≤–æ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ PlantUML —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è PlantUML:**
- [–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://plantuml.com/)
- [Component Diagrams](https://plantuml.com/component-diagram)
- [Sequence Diagrams](https://plantuml.com/sequence-diagram)

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

```
docs/
‚îú‚îÄ‚îÄ README.md                      # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ old-architecture.puml          # –°—Ç–∞—Ä–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (Windows Forms)
‚îú‚îÄ‚îÄ new-architecture.puml          # –ù–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (Backend + Clients)
‚îú‚îÄ‚îÄ architecture-comparison.puml   # –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä
‚îî‚îÄ‚îÄ sequence-diagram.puml          # –î–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
```

## üîÑ –≠–∫—Å–ø–æ—Ä—Ç –¥–∏–∞–≥—Ä–∞–º–º

–î–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –¥–∏–∞–≥—Ä–∞–º–º –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∏–ª–∏ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏:

```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PNG (—Ä–∞—Å—Ç—Ä–æ–≤—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)
plantuml -tpng docs/*.puml

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è SVG (–≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
plantuml -tsvg docs/*.puml

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PDF
plantuml -tpdf docs/*.puml
```

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ —Ç–æ–π –∂–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º–∏.

## üìù –°–æ–≥–ª–∞—à–µ–Ω–∏—è –æ–± –∏–º–µ–Ω–æ–≤–∞–Ω–∏–∏

- `old-architecture.puml` - —Å—Ç–∞—Ä–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- `new-architecture.puml` - –Ω–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- `architecture-comparison.puml` - —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ
- `sequence-diagram.puml` - –¥–∏–∞–≥—Ä–∞–º–º—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## ü§ù –í–∫–ª–∞–¥

–ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –¥–∏–∞–≥—Ä–∞–º–º:
1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `.puml` —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ
2. –î–æ–±–∞–≤—å—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤ —ç—Ç–æ—Ç README
3. –°–ª–µ–¥—É–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É —Å—Ç–∏–ª—é –¥–∏–∞–≥—Ä–∞–º–º
4. –î–æ–±–∞–≤–ª—è–π—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ –∑–∞–º–µ—Ç–∫–∏ –¥–ª—è —è—Å–Ω–æ—Å—Ç–∏

---

**–ê–≤—Ç–æ—Ä:** –ö–∞–∑–∞–∫–æ–≤ –ö–∏—Ä–∏–ª–ª –í–∞–ª–µ—Ä—å–µ–≤–∏—á, –ö–¢-31-21
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** –î–µ–∫–∞–±—Ä—å 2024
